<robot name="car_like_robot">

   <!-- Base Footprint -->
   <link name="base_footprint"/>
	<!-- Base Link -->

	<link name="base_link">
		<inertial>
			<mass value="150.0" />
			<inertia ixx="0.1" ixy="0" ixz="0" iyy="0.1" iyz="0" izz="0.1" />
		</inertial>
		<visual>
			<origin xyz="0.0 0 0.2" rpy="0 0 0" />

			<geometry>
				<box size="1.66 0.9 0.55" />
			</geometry>
		</visual>
		<collision>
			<origin xyz="0.0 0 0.2" rpy="0 0 0" />

			<geometry>
				<box size="1.66 0.9 0.55" />
			</geometry>
		</collision>
		<!-- back box -->
      <visual>
			<origin xyz="-1.0 0 0.025" rpy="0 0 0" />
			<geometry>
				<box size="0.4 0.86 0.3" />
			</geometry>
		</visual>
		<collision>
			<origin xyz="-0.82 0 0.025" rpy="0 0 0" />
			<geometry>
				<box size="0.4 0.8 0.3" />
			</geometry>
		</collision>

      <visual>
			<origin xyz="1.1 0 0.0" rpy="1.57 0 0" />
			<geometry>
            <cylinder radius="0.05" length="0.9"/>
			</geometry>
		</visual>
		
      <visual>
			<origin xyz="0.85 0 0.0" rpy="0.0 1.57 0" />
			<geometry>
            <cylinder radius="0.05" length="0.45"/>
			</geometry>
		</visual>

      <visual>
			<origin xyz="0.85 0 0.425" rpy="0.0 1.57 0" />
			<geometry>
            <box size="0.1 0.1 0.5"/>
			</geometry>
		</visual>
  	</link>
  
	<joint name="base" type="fixed">
      <parent link="base_footprint"/>
      <child link="base_link"/>
      <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
   </joint>
   
	<!-- Rear Left Wheel -->
	<link name="rear_left_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</collision>
	</link>

	<joint name="rear_left_wheel_joint" type="continuous">
		<parent link="base_link" />
		<child link="rear_left_wheel" />
		<origin xyz="-1.1 0.55 0" rpy="1.57 0 0" />
		<axis xyz="0 0 1" />
	</joint>

	<!-- Rear Right Wheel -->
	<link name="rear_right_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</collision>
	</link>

	<joint name="rear_right_wheel_joint" type="continuous">
		<parent link="base_link" />
		<child link="rear_right_wheel" />
		<origin xyz="-1.1 -0.55 0" rpy="1.57 0 0" />
		<axis xyz="0 0 1" />
	</joint>


	<transmission name="rear_left_wheel_joint_trans">
	<type>transmission_interface/SimpleTransmission</type>
	<actuator name="rear_left_wheel_joint_motor">
		<mechanicalReduction>1</mechanicalReduction>
		<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</actuator>
	<joint name="rear_left_wheel_joint">
		<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</joint>
	</transmission>

	<transmission name="rear_right_wheel_joint_trans">
	<type>transmission_interface/SimpleTransmission</type>
	<actuator name="rear_right_wheel_joint_motor">
		<mechanicalReduction>1</mechanicalReduction>
		<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</actuator>
	<joint name="rear_right_wheel_joint">
		<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</joint>
	</transmission>


	<!-- Front steer -->
	<link name="front_steering_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.25" length="0.05" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.1" length="0.05" />
			</geometry>
		</collision>
	</link>

	<joint name="front_steer_wheel_joint" type="revolute">
      <parent link="base_link" />
		<child link="front_steering_wheel" />
		<origin xyz="1.1 0.0 0.3" rpy="0 0 0" />
		<axis xyz="0 0 1" />
      <limit lower="-0.3" upper="0.3" velocity="5.0" effort="10.0"/>
	</joint>

	<link name="front_right_steer_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.25" length="0.05"/>
        </geometry>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.25" length="0.05"/>
        </geometry>
      </collision>
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
    </link>
	 <joint name="front_right_steer_joint" type="revolute">
      <parent link="base_link"/>
      <child link="front_right_steer_link"/>
      <origin xyz="1.1 -0.55 0.3" rpy="0 0 0"/>
      <axis xyz="0 0 1"/>
      <limit effort="10"
             lower="-0.35" upper="0.35"
             velocity="5.0"/>
    </joint>

	<!-- Front Right Wheel -->
	<link name="front_right_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</collision>
	</link>

	<joint name="front_right_wheel_joint" type="continuous">
      <parent link="front_right_steer_link" />
		<child link="front_right_wheel" />
		<origin xyz="0 0 -0.3" rpy="1.57 0 0" />
		<axis xyz="0 0 1" />
	</joint>

	<transmission name="front_right_steer_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="front_right_steer_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </actuator>
      <joint name="front_right_steer_joint">
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <transmission name="front_right_wheel_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="front_right_wheel_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </actuator>
      <joint name="front_right_wheel_joint">
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </joint>
    </transmission>

	
	<!-- Front Left Wheel -->
	<link name="front_left_steer_link">
	<visual>
		<origin xyz="0 0 0" rpy="0 0 0"/>
		<geometry>
			<cylinder radius="0.25" length="0.05"/>
		</geometry>
	</visual>
	<collision>
		<origin xyz="0 0 0" rpy="0 0 0"/>
		<geometry>
			<cylinder radius="0.25" length="0.05"/>
		</geometry>
	</collision>
	<inertial>
		<mass value="1.0" />
		<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
	</inertial>
	</link>

	<joint name="front_left_steer_joint" type="revolute">
		<parent link="base_link"/>
		<child link="front_left_steer_link"/>
		<origin xyz="1.1 0.55 0.3" rpy="0 0 0"/>
		<axis xyz="0 0 1"/>
	<limit effort="10"
				lower="-0.35" upper="0.35"
				velocity="5.0"/>
	</joint>

	<link name="front_left_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.25" length="0.20" />
			</geometry>
		</collision>
	</link>

		
	 <joint name="front_left_wheel_joint" type="continuous">
		 <parent link="front_left_steer_link" />
		 <child link="front_left_wheel" />
		 <origin xyz="0 0 -0.3" rpy="1.57 0 0" />
		 <axis xyz="0 0 1" />
	 </joint>
	 

	 <transmission name="front_left_steer_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="front_left_steer_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </actuator>
      <joint name="front_left_steer_joint">
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <transmission name="front_left_wheel_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="front_left_wheel_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </actuator>
      <joint name="front_left_wheel_joint">
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </joint>
    </transmission>

	<!-- Joints -->
	<!-- Rear Wheels (fixed, as they do not steer) -->


	<!-- Front Wheels (Ackermann steering) -->
	

	
	
	<!-- 3D LiDAR -->
	<link name="lidar">
		<inertial>
			<mass value="0.5" />
			<inertia ixx="0.005" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.005" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="0.05" length="0.05"/>
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="0.05" length="0.05"/>
			</geometry>
		</collision>
	</link>

   <joint name="lidar_joint" type="fixed">
      <parent link="base_link"/>
      <child link="lidar"/>
      <origin xyz="1.1 0.0 0.5" rpy="0.0 0.0 0.0"/>
   </joint>
   
	<!-- Camera -->
	<link name="camera">
		<inertial>
			<mass value="0.2" />
			<inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001" />
		</inertial>
		<visual>
			<geometry>
				<box size="0.05 0.05 0.05" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<box size="0.05 0.05 0.05" />
			</geometry>
		</collision>
	</link>
   <joint name="camera_joint" type="fixed">
      <parent link="base_link"/>
      <child link="camera"/>
      <origin xyz="1.1 0.0 0.4" rpy="0.0 0.0 0.0"/>
   </joint>
   
   <!-- Gazebo Plugins -->
  <!-- <gazebo reference="camera">
   <sensor type="camera" name="camera_sensor">
     <update_rate>30.0</update_rate>
     <camera name="head_camera">
       <horizontal_fov>1.3962634</horizontal_fov>
       <image>
         <width>800</width>
         <height>600</height>
         <format>R8G8B8</format>
       </image>
       <clip>
         <near>0.02</near>
         <far>300</far>
       </clip>
     </camera>
     <plugin name="camera_controller" filename="libgazebo_ros_camera.so">
       <alwaysOn>true</alwaysOn>
       <updateRate>0</updateRate>
       <cameraName>/camera</cameraName>
       <imageTopicName>image_raw</imageTopicName>
       <cameraInfoTopicName>camera_info</cameraInfoTopicName>
       <frameName>camera</frameName>
       <hackBaseline>0.07</hackBaseline>
       <distortionK1>0.0</distortionK1>
       <distortionK2>0.0</distortionK2>
       <distortionK3>0.0</distortionK3>
       <distortionT1>0.0</distortionT1>
       <distortionT2>0.0</distortionT2>
     </plugin>
   </sensor>
 </gazebo> -->

   <!-- Ackermann Steering Plugin -->

	<gazebo>

	<plugin name="ackermann_steering_controller" filename="libgazebo_ackermann_controller.so">
		<rosNamespace>/car_like_robot</rosNamespace>
		<updateRate>100.0</updateRate>
		<leftJoint>front_left_steer_joint</leftJoint>
		<rightJoint>front_right_steer_joint</rightJoint>
		<wheelBase>2.2</wheelBase>
		<wheelTrack>1.1</wheelTrack>
		<wheelRadius>0.25</wheelRadius>
		<cmdVelTopic>cmd_vel</cmdVelTopic>
		<odomFrame>odom</odomFrame>
		<baseFrame>base_link</baseFrame>
		<publishWheelTF>true</publishWheelTF>
		<publishWheelJointState>true</publishWheelJointState>
	</plugin>
	

      <!-- <plugin name='ackermann_drive' filename='libgazebo_ros_ackermann_drive.so'>
         <update_rate>100.0</update_rate>
         <front_left_joint>front_left_wheel_joint</front_left_joint>
         <front_right_joint>front_right_wheel_joint</front_right_joint>
         <rear_left_joint>rear_left_wheel_joint</rear_left_joint>
         <rear_right_joint>rear_right_wheel_joint</rear_right_joint>
         <left_steering_joint>front_left_steer_joint</left_steering_joint>
         <right_steering_joint>front_right_steer_joint</right_steering_joint>
         <steering_wheel_joint>front_steer_wheel_joint</steering_wheel_joint>
         <max_steer>0.6458</max_steer>
         <max_steering_angle>7.85</max_steering_angle>
         <max_speed>20</max_speed>
         <left_steering_pid_gain>1 0 1</left_steering_pid_gain>
         <left_steering_i_range>0 0</left_steering_i_range>
         <right_steering_pid_gain>1 0 1</right_steering_pid_gain>
         <right_steering_i_range>0 0</right_steering_i_range>
         <linear_velocity_pid_gain>1 0 1</linear_velocity_pid_gain>
         <linear_velocity_i_range>0 0</linear_velocity_i_range>
         <publish_odom>1</publish_odom>
         <publish_odom_tf>1</publish_odom_tf>
         <publish_wheel_tf>1</publish_wheel_tf>
         <publish_distance>1</publish_distance>
         <odometry_frame>odom</odometry_frame>
         <robot_base_frame>base_link</robot_base_frame>
       </plugin> -->

    
    </gazebo>
    
</robot>
