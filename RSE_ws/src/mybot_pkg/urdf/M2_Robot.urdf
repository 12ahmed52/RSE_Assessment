<robot name="car_like_robot" xmlns:xacro="http://www.ros.org/wiki/xacro">

   <!-- Base Footprint -->
   <link name="base_footprint"/>
	<!-- Base Link -->
	<xacro:property name="wheel_redius" value="0.15"/>
	<xacro:property name="wheel_length" value="0.1"/>
	<xacro:include filename="$(find realsense2_description)/urdf/_d435.urdf.xacro" />
   <xacro:include filename="$(find velodyne_description)/urdf/HDL-32E.urdf.xacro"/>

	<link name="base_link">
		<inertial>
			<mass value="200.0" />
			<inertia ixx="0.1" ixy="0" ixz="0" iyy="0.1" iyz="0" izz="0.1" />
		</inertial>
		<visual>
			<origin xyz="0.0 0 0.15" rpy="0 0 0" />

			<geometry>
				<box size="0.83 0.45 0.275" />
			</geometry>
		</visual>
		<collision>
			<origin xyz="0.0 0 0.15" rpy="0 0 0" />

			<geometry>
				<box size="0.83 0.45 0.275" />
			</geometry>
		</collision>
		<!-- back box -->
      <visual>
			<origin xyz="-0.4 0 0.05" rpy="0 0 0" />
			<geometry>
				<box size="0.4 0.45 0.15" />
			</geometry>
		</visual>
		<collision>
			<origin xyz="-0.6 0 0.05" rpy="0 0 0" />
			<geometry>
				<box size="0.4 0.4 0.15" />
			</geometry>
		</collision>

      <visual>
			<origin xyz="0.65 0 0.0" rpy="1.57 0 0" />
			<geometry>
            <cylinder radius="0.025" length="0.45"/>
			</geometry>
		</visual>
		
      <visual>
			<origin xyz="0.50 0 0.0" rpy="0.0 1.57 0" />
			<geometry>
            <cylinder radius="0.025" length="0.3"/>
			</geometry>
		</visual>

      <visual>
			<origin xyz="0.425 0 0.235" rpy="0.0 1.57 0" />
			<geometry>
            <box size="0.1 0.1 0.5"/>
			</geometry>
		</visual>
  	</link>
  
	<joint name="base" type="fixed">
      <parent link="base_footprint"/>
      <child link="base_link"/>
      <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
   </joint>
   
	<!-- Rear Left Wheel -->
	<link name="rear_left_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</collision>
	</link>

	<!-- Rear Right Wheel -->
	<link name="rear_right_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</collision>
	</link>

	<!-- Front Left Wheel -->
	<link name="front_left_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</collision>
	</link>

	<!-- Front Right Wheel -->
	<link name="front_right_wheel">
		<inertial>
			<mass value="1.0" />
			<inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01" />
		</inertial>
		<visual>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</visual>
		<collision>
			<geometry>
				<cylinder radius="${wheel_redius}" length="${wheel_length}" />
			</geometry>
		</collision>
	</link>

	<!-- Joints -->
	<!-- Rear Wheels (fixed, as they do not steer) -->
	<joint name="rear_left_wheel_joint" type="continuous">
		<parent link="base_link" />
		<child link="rear_left_wheel" />
		<origin xyz="-0.5 0.28 0" rpy="1.57 0 0" />
		<axis xyz="0 0 1" />
	</joint>
	<joint name="rear_right_wheel_joint" type="continuous">
		<parent link="base_link" />
		<child link="rear_right_wheel" />
		<origin xyz="-0.5 -0.28 0" rpy="1.57 0 0" />
		<axis xyz="0 0 1" />
	</joint>
	<!-- Front Wheels (Ackermann steering) -->
	<joint name="front_left_wheel_joint" type="revolute">
		<parent link="base_link" />
		<child link="front_left_wheel" />
		<origin xyz="0.65 0.25 0" rpy="1.57 0 0" />
		<axis xyz="0 1 0" />
      <limit lower="-0.3" upper="0.3" velocity="5.0" effort="1000.0"/>
	</joint>
   
	<joint name="front_right_wheel_joint" type="revolute">
      <parent link="base_link" />
		<child link="front_right_wheel" />
		<origin xyz="0.65 -0.25 0" rpy="1.57 0 0" />
		<axis xyz="0 1 0" />
      <limit lower="-0.3" upper="0.3" velocity="5.0" effort="1000.0"/>
	</joint>
	
	<!-- 3D LiDAR -->

  <xacro:HDL-32E parent="base_link" name="velodyne2" topic="/velodyne_points2" hz="10" samples="220" gpu="false">
    <origin xyz="0.60 0 0.25" rpy="0 0 0" />
  </xacro:HDL-32E>

	<!-- Camera -->

	<xacro:sensor_d435 name="camera" topics_ns="camera" parent="base_link" publish_pointcloud="true">
    <origin xyz="0.68 0.0 0.2" rpy="0 0 0" />
  </xacro:sensor_d435>  



   <!-- Ackermann Steering Plugin -->
   <!-- <gazebo>
      <plugin name="ackermann_steering_controller" filename="libgazebo_ackermann_controller.so">
        <rosNamespace>/car_like_robot</rosNamespace>
        <updateRate>100.0</updateRate>
        <leftJoint>front_left_wheel_joint</leftJoint>
        <rightJoint>front_right_wheel_joint</rightJoint>
        <wheelBase>2.2</wheelBase>
        <wheelTrack>1.1</wheelTrack>
        <wheelRadius>0.25</wheelRadius>
        <cmdVelTopic>cmd_vel</cmdVelTopic>
        <odomFrame>odom</odomFrame>
        <baseFrame>base_footprint</baseFrame>
        <publishWheelTF>true</publishWheelTF>
        <publishWheelJointState>true</publishWheelJointState>
      </plugin>


      <plugin name='ackermann_drive' filename='libgazebo_ros_ackermann_drive.so'>
         <update_rate>100.0</update_rate>
         <front_left_joint>front_left_wheel_joint</front_left_joint>
         <front_right_joint>front_right_wheel_joint</front_right_joint>
         <rear_left_joint>rear_left_wheel_joint</rear_left_joint>
         <rear_right_joint>rear_right_wheel_joint</rear_right_joint>
         <left_steering_joint>front_left_wheel_joint</left_steering_joint>
         <right_steering_joint>front_right_wheel_joint</right_steering_joint>
         <steering_wheel_joint>front_right_wheel_joint</steering_wheel_joint>
         <max_steer>0.6458</max_steer>
         <max_steering_angle>7.85</max_steering_angle>
         <max_speed>20</max_speed>
         <left_steering_pid_gain>1 0 1</left_steering_pid_gain>
         <left_steering_i_range>0 0</left_steering_i_range>
         <right_steering_pid_gain>1 0 1</right_steering_pid_gain>
         <right_steering_i_range>0 0</right_steering_i_range>
         <linear_velocity_pid_gain>1 0 1</linear_velocity_pid_gain>
         <linear_velocity_i_range>0 0</linear_velocity_i_range>
         <publish_odom>1</publish_odom>
         <publish_odom_tf>1</publish_odom_tf>
         <publish_wheel_tf>1</publish_wheel_tf>
         <publish_distance>1</publish_distance>
         <odometry_frame>odom</odometry_frame>
         <robot_base_frame>base_link</robot_base_frame>
       </plugin>

    
    </gazebo> -->
    

</robot>
